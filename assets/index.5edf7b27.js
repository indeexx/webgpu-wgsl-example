var u=Object.defineProperty;var l=(i,e,r)=>e in i?u(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r;var n=(i,e,r)=>(l(i,typeof e!="symbol"?e+"":e,r),r);import{_ as m,R as c}from"./vendor.5b22622a.js";const f="_part_pfhqm_1",v="_card_pfhqm_1",p="_footer_pfhqm_4";var g={part:f,card:v,footer:p},w=`@stage(vertex)
fn main(@builtin(vertex_index) VertexIndex : u32) -> @builtin(position) vec4<f32> {
    var pos = array<vec2<f32>, 3>(
	    vec2<f32>(0.0, 0.5),
	    vec2<f32>(-0.5, -0.5),
	    vec2<f32>(0.5, -0.5)
    );
    return vec4<f32>(pos[VertexIndex], 0.0, 1.0);
}`,x=`@stage(fragment)
fn main() -> @location(0) vec4<f32> {
    return vec4<f32>(1.0, 0.0, 0.0, 1.0);
}`;class _{constructor(e){n(this,"adapter");n(this,"device");n(this,"context");n(this,"format");n(this,"pipeline");n(this,"devicePixelRatio",window.devicePixelRatio|1);n(this,"size",[0,0]);this.canvas=e,this.canvas=e;let r=e.clientWidth*this.devicePixelRatio,a=e.clientHeight*this.devicePixelRatio;this.size=[r,a]}async start(){await this.init()}async init(){var e,r;if(!this.canvas)throw new Error("\u6CA1\u6709Canvas Element");if(!navigator.gpu)throw new Error("\u4E0D\u652F\u6301GPU");if(this.adapter=await navigator.gpu.requestAdapter({powerPreference:"high-performance"})||void 0,!this.adapter)throw new Error("\u83B7\u53D6\u8BBE\u5907\u5931\u8D25");if(this.device=await this.adapter.requestDevice(),!this.device)throw new Error("\u8BBE\u5907\u672A\u627E\u5230");this.context=this.canvas.getContext("webgpu")||void 0,this.format=(e=this.context)==null?void 0:e.getPreferredFormat(this.adapter),(r=this.context)==null||r.configure({device:this.device,format:this.format,size:this.size,compositingAlphaMode:"opaque"}),await this.run()}async run(){await this.initPipeline(),this.draw()}async initPipeline(){const e={vertex:{module:this.device.createShaderModule({code:w}),entryPoint:"main"},fragment:{module:this.device.createShaderModule({code:x}),entryPoint:"main",targets:[{format:this.format}]},primitive:{topology:"triangle-list"}};this.pipeline=await this.device.createRenderPipelineAsync(e)}async draw(){var o,s;const e=(o=this.device)==null?void 0:o.createCommandEncoder(),a={colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store",loadValue:{r:0,g:0,b:0,a:1}}]},t=e.beginRenderPass(a);t==null||t.setPipeline(this.pipeline),t==null||t.draw(3,1,0,0),t!=null&&t.endPass?t.endPass():t==null||t.end();const h=e.finish();(s=this.device)==null||s.queue.submit([h])}}var d="/Users/indeex/Documents/program/indeex/program/webGPU/wgsl-base/src/component/part4/index.tsx";const y=()=>(m.exports.useEffect(()=>{const i=document.getElementById("gfx");i.width=document.body.clientWidth,i.height=document.body.clientHeight,new _(i).start(),window.onresize=function(){i.width=document.body.clientWidth,i.height=document.body.clientHeight}}),c.createElement("div",{className:g.part,__self:globalThis,__source:{fileName:d,lineNumber:17,columnNumber:10}},c.createElement("canvas",{id:"gfx",__self:globalThis,__source:{fileName:d,lineNumber:18,columnNumber:5}})));export{y as default};
